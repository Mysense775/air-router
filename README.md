# AI Router Platform

**OpenRouter Reseller API Platform** ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ AI-–º–æ–¥–µ–ª—è–º —á–µ—Ä–µ–∑ OpenRouter API —Å –±–∏–ª–ª–∏–Ω–≥–æ–º –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∫–ª–∏–µ–Ω—Ç–∞–º–∏.

## üéØ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

AI Router –≤—ã—Å—Ç—É–ø–∞–µ—Ç –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–º –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ OpenRouter:
- –ü–æ–∫—É–ø–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ OpenRouter —Å–æ —Å–∫–∏–¥–∫–æ–π (—á–µ—Ä–µ–∑ –º–∞—Å—Ç–µ—Ä-–∞–∫–∫–∞—É–Ω—Ç—ã)
- –ü–µ—Ä–µ–ø—Ä–æ–¥–∞—ë—Ç –∫–ª–∏–µ–Ω—Ç–∞–º —Å –Ω–∞—Ü–µ–Ω–∫–æ–π
- –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ —Ä–∞–∑–Ω–∏—Ü–µ (~50% –º–∞—Ä–∂–∞)

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ö–ª–∏–µ–Ω—Ç    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  AI Router   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ OpenRouter  ‚îÇ
‚îÇ  (API Key)  ‚îÇ     ‚îÇ  (–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞) ‚îÇ     ‚îÇ  (Upstream) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  PostgreSQL ‚îÇ
                    ‚îÇ  (–õ–æ–≥–∏,     ‚îÇ
                    ‚îÇ   –±–∞–ª–∞–Ω—Å—ã)  ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üí∞ –ë–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª—å

```
–¶–µ–Ω–∞ OpenRouter:     $0.010 –∑–∞ 1K —Ç–æ–∫–µ–Ω–æ–≤ (100%)
–ù–∞—à–∞ —Ü–µ–Ω–∞ (30%):     $0.003                          ‚Üê –ø–ª–∞—Ç–∏–º OpenRouter
–¶–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç—É (80%):  $0.008                          ‚Üê —Å–ø–∏—Å—ã–≤–∞–µ–º —Å –∫–ª–∏–µ–Ω—Ç–∞
–ü—Ä–∏–±—ã–ª—å:             $0.005 (50% –º–∞—Ä–∂–∞)              ‚Üê –Ω–∞—à –∑–∞—Ä–∞–±–æ—Ç–æ–∫
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### URL
- **Web UI:** https://airouter.host
- **API:** https://airouter.host/v1
- **Health:** https://airouter.host/health

### –¢–µ—Å—Ç–æ–≤—ã–π –¥–æ—Å—Ç—É–ø (–∞–≤—Ç–æ-–≤—Ö–æ–¥)
- –û—Ç–∫—Ä—ã–≤–∞–µ—à—å https://airouter.host ‚Äî —Å—Ä–∞–∑—É Dashboard
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞ (TEST_MODE)
- –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –æ—Ç –∏–º–µ–Ω–∏ Administrator

### API Key –¥–ª—è —Ç–µ—Å—Ç–æ–≤
–°–æ–∑–¥–∞—ë—à—å –≤ —Ä–∞–∑–¥–µ–ª–µ "API Keys" ‚Üí "Create Key" ‚Üí –∫–æ–ø–∏—Ä—É–µ—à—å

### –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
```bash
curl -X POST https://airouter.host/v1/chat/completions \
  -H "Authorization: Bearer —Ç–≤–æ–π_api_–∫–ª—é—á" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "openai/gpt-4o-mini",
    "messages": [{"role": "user", "content": "Hello!"}]
  }'
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ai-router-platform/
‚îú‚îÄ‚îÄ backend/                 # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/v1/         # API endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py     # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (JWT)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ proxy.py    # –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ OpenRouter
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.py   # –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ admin.py    # –ê–¥–º–∏–Ω endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, security
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/         # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/       # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (billing)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ db/             # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ frontend/               # React + Vite + Tailwind
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/          # –°—Ç—Ä–∞–Ω–∏—Ü—ã (Login, Dashboard, Admin)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/     # Layout, Sidebar, Header
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/client.ts   # Axios –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ store/          # Zustand store
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ docker-compose.yml      # –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
```

## üîå API Endpoints

### –ü—É–±–ª–∏—á–Ω—ã–µ
| –ú–µ—Ç–æ–¥ | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----|----------|
| POST | `/v1/auth/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è |
| POST | `/v1/auth/login` | –í—Ö–æ–¥ (JWT) |
| POST | `/v1/auth/refresh` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ |
| GET | `/v1/health` | –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ |

### –¢—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
| –ú–µ—Ç–æ–¥ | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----|----------|
| GET | `/v1/auth/me` | –ò–Ω—Ñ–æ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ |
| GET | `/v1/auth/api-keys` | –°–ø–∏—Å–æ–∫ API –∫–ª—é—á–µ–π |
| POST | `/v1/auth/api-keys` | –°–æ–∑–¥–∞—Ç—å –∫–ª—é—á |
| DELETE | `/v1/auth/api-keys/{id}` | –û—Ç–æ–∑–≤–∞—Ç—å –∫–ª—é—á |

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ
| –ú–µ—Ç–æ–¥ | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----|----------|
| GET | `/v1/client/balance` | –ë–∞–ª–∞–Ω—Å |
| GET | `/v1/client/usage` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| GET | `/v1/client/usage/daily` | –ü–æ –¥–Ω—è–º |
| GET | `/v1/client/models/usage` | –ü–æ –º–æ–¥–µ–ª—è–º |
| GET | `/v1/client/recent-requests` | –õ–æ–≥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ |

### –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ OpenRouter
| –ú–µ—Ç–æ–¥ | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----|----------|
| POST | `/v1/chat/completions` | –û—Å–Ω–æ–≤–Ω–æ–π endpoint |
| GET | `/v1/models` | –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π |

### –ê–¥–º–∏–Ω—Å–∫–∏–µ (role=admin)
| –ú–µ—Ç–æ–¥ | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----|----------|
| GET | `/v1/admin/stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã |
| GET | `/v1/admin/clients` | –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| GET | `/v1/admin/master-accounts` | –ú–∞—Å—Ç–µ—Ä-–∞–∫–∫–∞—É–Ω—Ç—ã |
| GET | `/v1/admin/logs` | –õ–æ–≥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ |

## üíæ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã

**users**
- id, email, password_hash, name, role (admin/client), status

**api_keys**
- id, user_id, key_hash (SHA256), name, is_active, last_used_at

**balances**
- user_id, balance_usd, lifetime_spent, lifetime_earned

**request_logs**
- user_id, api_key_id, model, tokens, cost_to_client_usd, profit_usd

**master_accounts**
- api_key_encrypted, balance_usd, discount_percent (–æ–±—ã—á–Ω–æ 70%)

**model_pricing**
- id, provider, prompt_price, completion_price, is_active

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### JWT Flow
1. POST `/v1/auth/login` ‚Üí –ø–æ–ª—É—á–∞–µ—à—å access_token + refresh_token
2. –ò—Å–ø–æ–ª—å–∑—É–µ—à—å access_token –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ: `Authorization: Bearer {token}`
3. Access token –¥–µ–π—Å—Ç–≤—É–µ—Ç 15 –º–∏–Ω—É—Ç
4. Refresh token –¥–µ–π—Å—Ç–≤—É–µ—Ç 7 –¥–Ω–µ–π

### –†–æ–ª–∏
- **client** ‚Äî Dashboard, API Keys, Usage, –±–∞–ª–∞–Ω—Å
- **admin** ‚Äî + Admin Panel (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –∫–ª–∏–µ–Ω—Ç—ã, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (backend/.env)
```env
# Database
DATABASE_URL=postgresql+asyncpg://postgres:postgres@db:5432/ai_router

# Redis
REDIS_URL=redis://redis:6379/0

# OpenRouter
OPENROUTER_MASTER_KEYS=sk-or-v1-xxx,sk-or-v1-yyy
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1

# Security
SECRET_KEY=your-secret-key
ENCRYPTION_KEY=your-encryption-key

# Email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password

# Payments (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
STRIPE_SECRET_KEY=sk_xxx
YOOKASSA_SHOP_ID=xxx
YOOKASSA_SECRET_KEY=xxx
```

## üê≥ Docker

### –ó–∞–ø—É—Å–∫
```bash
cd ai-router-platform
docker-compose up -d
```

### –°–µ—Ä–≤–∏—Å—ã
| –°–µ—Ä–≤–∏—Å | –ü–æ—Ä—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|------|----------|
| backend | 8000 | FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ |
| frontend | 3000 | Nginx (—Å—Ç–∞—Ç–∏–∫–∞) |
| db | 5433 | PostgreSQL |
| redis | 6379 | Redis |
| prometheus | 9090 | –ú–µ—Ç—Ä–∏–∫–∏ |
| grafana | 3100 | –î–∞—à–±–æ—Ä–¥—ã |

### –õ–æ–≥–∏
```bash
# Backend
docker logs -f ai-router-platform-backend-1

# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose logs -f
```

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
```bash
# Backend
docker restart ai-router-platform-backend-1

# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose restart
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
```bash
cd ai-router-platform/frontend
npm run build
cp -r dist/* /var/www/airouter/
```

### –ë—ç–∫–∞–ø –±–∞–∑—ã
```bash
docker exec ai-router-platform-db-1 pg_dump -U postgres ai_router > backup.sql
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
docker exec -i ai-router-platform-db-1 psql -U postgres -d ai_router < backup.sql
```

## üìù –ü–æ—Ä—Ç—ã (–Ω–µ –º–µ–Ω—è—Ç—å!)

| –ü—Ä–æ–µ–∫—Ç | –°–µ—Ä–≤–∏—Å | –•–æ—Å—Ç –ø–æ—Ä—Ç | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä |
|--------|--------|-----------|-----------|
| **AI Router** | PostgreSQL | 5433 | 5432 |
| **AI Router** | Redis | 6379 | 6379 |
| **AI Router** | Backend | 8000 | 8000 |
| **AI Router** | Frontend | 3000 | 80 |
| **AI Router** | Prometheus | 9090 | 9090 |
| **AI Router** | Grafana | 3100 | 3000 |
| **GPU Pool** | PostgreSQL | 5432 | 5432 |
| **GPU Pool** | Redis | 6380 | 6379 |
| **GPU Pool** | Backend | 8002 | 8000 |
| **GPU Pool** | Frontend | 3001 | 3000 |

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏

1. **–ù–µ—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞** ‚Äî –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ SQL
2. **–ù–µ—Ç –∞–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω –º–æ–¥–µ–ª–µ–π**
3. **–ù–µ—Ç email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**
4. **–ù–µ—Ç rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
5. **TEST_MODE = True** ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤!)

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Backend:** Python 3.12, FastAPI, SQLAlchemy (async), Pydantic
- **Frontend:** React 18, TypeScript, Vite, Tailwind CSS, Zustand
- **Database:** PostgreSQL 15, Redis 7
- **Infra:** Docker, Nginx, Let's Encrypt SSL
- **Monitoring:** Prometheus, Grafana

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

Email: support@ai-router.com  
URL: https://airouter.host

---

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–î–∞—Ç–∞ —Å–±–æ—Ä–∫–∏:** 2026-02-13  
**–°—Ç–∞—Ç—É—Å:** –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞)
